--------------------------------------
-- CREA USUARIOS
--------------------------------------
DROP USER USUARIO1 CASCADE;
CREATE USER USUARIO1 IDENTIFIED BY 1234 ACCOUNT UNLOCK;

GRANT CREATE TABLE TO USUARIO1 WITH ADMIN OPTION;
GRANT CREATE ANY TABLE TO USUARIO1;
GRANT CONNECT TO USUARIO1;
GRANT CONNECT, RESOURCE, DBA TO USUARIO1;
GRANT CREATE SESSION TO USUARIO1;
GRANT UNLIMITED TABLESPACE TO USUARIO1;

CONNECT USUARIO1/1234;
--CONNECT SYSTEM/1234;

--DROP TABLE CLIENTES;
--DROP TABLE USUARIO1.PRODUCTOS;
--DROP TABLE VENTAS;
------------------------------------
-- CREA LAS TABLAS
------------------------------------
CREATE TABLE USUARIO1.CLIENTES
(
    CD_CLIENTE VARCHAR2(10) NOT NULL,
    ST_NOMBRE VARCHAR2(30) NULL,
    TX_DIRECCION VARCHAR(200) NULL,
    ST_STATUS CHAR(1) CONSTRAINT CONSTRAINT001 CHECK (ST_STATUS IN ('S', 'N')),
    NU_NUMERO1 INTEGER NULL,
    NU_NUMERO2 INTEGER NULL,
    FH_FECHA DATE NULL
);

CREATE TABLE USUARIO1.PRODUCTOS
(
    CD_PRODUCTO VARCHAR2(10) NOT NULL,
    ST_NOMBRE VARCHAR2(30) NULL
);

CREATE TABLE USUARIO1.VENTAS
(
    CD_NUMERO_VENTA NUMBER NOT NULL,
    CD_PRODUCTO VARCHAR2(10) NOT NULL,
    CD_CLIENTE VARCHAR2(10) NOT NULL,
    NU_CANTIDAD NUMBER NULL,
    FH_FECHA DATE NULL
);
--------------------------------------
--  CREA LOS INDICES
--------------------------------------
CREATE UNIQUE INDEX CLIENTE_001 ON USUARIO1.CLIENTES
(
    CD_CLIENTE ASC
);
CREATE UNIQUE INDEX PRODUCTOS_001 ON USUARIO1.PRODUCTOS
(
    CD_PRODUCTO ASC
);
CREATE UNIQUE INDEX VENTAS_001 ON USUARIO1.VENTAS
(
    CD_NUMERO_VENTA ASC,
    CD_PRODUCTO ASC,
    CD_CLIENTE ASC
);

-----------------------------------------
--  CREA LA LLAVE PRIMARIA
-----------------------------------------
ALTER TABLE USUARIO1.CLIENTES
ADD CONSTRAINT CLIENTE_001 PRIMARY KEY
(
    CD_CLIENTE
);
ALTER TABLE USUARIO1.PRODUCTOS
ADD CONSTRAINT PRODUCTOS_001 PRIMARY KEY
(
    CD_PRODUCTO
);
ALTER TABLE USUARIO1.VENTAS
ADD CONSTRAINT VENTAS_001 PRIMARY KEY
(
    CD_NUMERO_VENTA,
    CD_PRODUCTO,
    CD_CLIENTE
);

-----------------------------------------
-- CREA LAS LLAVES FORANEAS O FOREIGN KEY
-----------------------------------------
ALTER TABLE USUARIO1.VENTAS ADD (CONSTRAINT VENTAS_CLIENTES FOREIGN KEY (CD_CLIENTE) REFERENCES USUARIO1.CLIENTES (CD_CLIENTE));
ALTER TABLE USUARIO1.VENTAS ADD (CONSTRAINT VENTAS_PRODUCTOS FOREIGN KEY (CD_PRODUCTO) REFERENCES USUARIO1.PRODUCTOS (CD_PRODUCTO));

-----------------------------------------
-- CARGA DE DATOS GLOBAL
-----------------------------------------
INSERT INTO USUARIO1.CLIENTES (CD_CLIENTE, ST_NOMBRE, TX_DIRECCION, ST_STATUS, NU_NUMERO1, NU_NUMERO2, FH_FECHA)
VALUES (1, 'CLIENTE 1', 'CALLE 12', 'S', 1001, 2001, '10/10/2025');

INSERT INTO USUARIO1.CLIENTES (CD_CLIENTE, ST_NOMBRE, TX_DIRECCION, ST_STATUS, NU_NUMERO1, NU_NUMERO2, FH_FECHA)
VALUES (2, 'CLIENTE 2', 'CALLE 13', 'S', 1002, 2002, '10/10/2025');



INSERT INTO USUARIO1.PRODUCTOS (CD_PRODUCTO, ST_NOMBRE)
VALUES (1, 'PRODUCTO 1');

INSERT INTO USUARIO1.PRODUCTOS (CD_PRODUCTO, ST_NOMBRE)
VALUES (2, 'PRODUCTO 2');


INSERT INTO USUARIO1.VENTAS (CD_NUMERO_VENTA, CD_PRODUCTO, CD_CLIENTE, NU_CANTIDAD, FH_FECHA)
VALUES (1, 1, 1, 8, '10/10/2025');

INSERT INTO USUARIO1.VENTAS (CD_NUMERO_VENTA, CD_PRODUCTO, CD_CLIENTE, NU_CANTIDAD, FH_FECHA)
VALUES (2, 2, 1, 10, '10/10/2025');

INSERT INTO USUARIO1.VENTAS (CD_NUMERO_VENTA, CD_PRODUCTO, CD_CLIENTE, NU_CANTIDAD, FH_FECHA)
VALUES (3, 1, 2, 12, '10/10/2025');

INSERT INTO USUARIO1.VENTAS (CD_NUMERO_VENTA, CD_PRODUCTO, CD_CLIENTE, NU_CANTIDAD, FH_FECHA)
VALUES (4, 2, 2, 14, '10/10/2025');

INSERT INTO USUARIO1.VENTAS (CD_NUMERO_VENTA, CD_PRODUCTO, CD_CLIENTE, NU_CANTIDAD, FH_FECHA)
VALUES (5, 1, 2, 14, '10/10/2025');

COMMIT;

SELECT * FROM USUARIO1.CLIENTES;
SELECT * FROM USUARIO1.PRODUCTOS;
SELECT * FROM USUARIO1.VENTAS;

CONNECT SYSTEM/1234;